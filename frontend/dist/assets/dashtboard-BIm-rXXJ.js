import{u as K,r as p,o as O,a as h,b as w,c as k,d as c,w as u,e as n,f as l,g as z,D as ae,h as se,i as oe,j as C,n as le,F as ne,R as x,t as V,k as B,l as U,m as re,_ as ie,p as e}from"./index-BTxt8QXF.js";var r=[];for(var P=0;P<256;++P)r.push((P+256).toString(16).slice(1));function ce(t,a=0){return(r[t[a+0]]+r[t[a+1]]+r[t[a+2]]+r[t[a+3]]+"-"+r[t[a+4]]+r[t[a+5]]+"-"+r[t[a+6]]+r[t[a+7]]+"-"+r[t[a+8]]+r[t[a+9]]+"-"+r[t[a+10]]+r[t[a+11]]+r[t[a+12]]+r[t[a+13]]+r[t[a+14]]+r[t[a+15]]).toLowerCase()}var D,de=new Uint8Array(16);function ue(){if(!D&&(D=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!D))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return D(de)}var pe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const F={randomUUID:pe};function fe(t,a,v){if(F.randomUUID&&!a&&!t)return F.randomUUID();t=t||{};var f=t.random||(t.rng||ue)();return f[6]=f[6]&15|64,f[8]=f[8]&63|128,ce(f)}const me=l("span",{class:"text-white material-symbols-outlined"}," notifications ",-1),he={__name:"ring",setup(t){let a=K();p(0);let v=p(0),f=p([]),_=function(){a.push("/")},$=async function(){const b=localStorage.token;let d=await fetch(`${z}notification/status`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":b}});d.status==200&&(d=await d.json(),f.value=[],d.forEach(i=>{v.value++,f.value.push({label:`${i.title} : ${new Date(i.start_time).toLocaleString()} ${new Date(i.end_time).toLocaleString()}`,key:`${fe()}`})})),d.status==401&&a.push("/login")};return O(async()=>{$()}),setInterval(()=>{$(),v.value=0},6e4),(b,d)=>{const i=h("n-badge"),M=h("n-dropdown");return w(),k("div",null,[c(M,{trigger:"hover",options:n(f),onSelect:n(_)},{default:u(()=>[c(i,{class:"me-3",value:n(v),max:100},{default:u(()=>[me]),_:1},8,["value"])]),_:1},8,["options","onSelect"])])}}},_e={class:"bg-gray-200 overflow-hidden w-[100vw] h-[100vh]"},ge={class:"w-full h-[50px] flex justify-between items-center bg-gray-900"},xe=l("span",{class:"me-5 flex justify-center w-[240px] block absolute text-white select-none text-[28px] flex items-center gap-1 top-[10px] left-[10px] font-semibold"},[l("img",{src:ie,class:"w-[40px]",alt:""}),B(" "+V("Aileet"))],-1),ve={class:"flex gap-3 items-center"},be=["src"],ye={class:"h-full w-[200px] cursor-pointer me-4"},we={class:"h-full ps-3 flex items-center w-full border-s-[1px]"},ke=["src"],Se={class:"flex flex-col"},ze={class:"text-white font-bold ps-3"},$e=l("span",{class:"text-white text-[12px] text-center"},"Admin",-1),Le={class:"p-3 pb-[100px]"},Te={for:"picture"},je={key:0,class:"w-[500px] cursor-pointer flex justify-center text-teal-500"},Ue=l("i",{class:"fas fa-cloud-arrow-up text-[40px] text-center"},null,-1),De=[Ue],Me=["src"],Ie={class:"flex w-[600px] mx-auto mt-3 justify-around items-baseline"},Re={for:"picture"},Ce={key:0,id:"bt",class:"rounded pe-3 ps-3 px-5 py-3 min-w-max overflow-hidden shadow relative bg-teal-500 text-white hover:bg-opacity-90"},Pe=l("i",{class:"fas fa-camera"},null,-1),Ve=[Pe],Ae={key:0,type:"submit",id:"bt",class:"rounded px-5 py-3 min-w-max overflow-hidden shadow block relative bg-teal-500 text-white hover:bg-opacity-90"},He={__name:"dashtboard",setup(t){let a=ae(),v={width:"600px"},f={content:"soft",footer:"soft"},_=p(!1),$=p(null),b;const d=p(null);let i=p(!1);const M=s=>{const o=s.target.files[0];if($.value=s.target.files[0],o&&o.type.startsWith("image/")){b=new FormData,b.append("image",o),i.value=!0;const S=new FileReader;S.onload=()=>{d.value=S.result},S.readAsDataURL(o)}else T.error("Please select a valid image file."),s.target.value=""},q=async()=>{let s=localStorage.token;if(i.value){let o=await fetch(`${z}admin/changePhoto`,{method:"POST",headers:{"-x-token":s},body:b});if(o.status==200){i.value=!1,d.value=null,_.value=!1,A();return}if(o.status==401)return L.push("/login");if(o.status==400){o=await o.json(),T.error(o.error);return}d.value=null,o=await o.json(),i.value=!1}else T.error("No image selected.")};let m=p({profil_url:"",lastname:"",firstname:""});const L=K();async function A(){await a.getProfil()==401&&L.push("/login"),m.value=a.profile}O(async()=>{await A()});let I=p("uz"),W=[{label:"O'zb",key:"uz"},{label:"En",key:"en"}];function G(s){String(s)=="en"&&(localStorage.setItem("lang","en"),I.value="en"),String(s)=="uz"&&(localStorage.setItem("lang","uz"),I.value="uz")}function y(s){return()=>e("i",{class:s})}function R(s){return()=>e("span",{class:"material-symbols-outlined"},{default:()=>s})}let E=p(!0);const J=[{label:"Murojaatlar",key:"pinball-1973",icon:R("group"),disabled:!1,children:[{label:()=>e(x,{to:"/allApeals"},{default:()=>"Murojaatlar"}),key:"addWorker",icon:R("group_add")},{label:()=>e(x,{to:"/Notification_apeal"},{default:()=>"Kutilyotgan murojaatlar"}),key:"Notification_apeal ",icon:y("fas fa-clock-rotate-left")},{label:()=>e(x,{to:"/Kalindar"},{default:()=>"Kalindar"}),key:"issues ",icon:y("fas fa-receipt")}]},{label:"Tizim",key:"Tizim",icon:R("engineering"),children:[{label:()=>e(x,{to:"/editprofil"},{default:()=>"Profilni tahrirlash"}),key:"Davomat",icon:y("fas fa-user-pen")},{label:()=>e(x,{to:"/changepassword"},{default:()=>"Parolni almashtirish"}),key:"changepassword",icon:y("fas fa-lock")}]},{label:()=>e(x,{to:"/korzinka"},{default:()=>"Korzinka"}),key:"kontrakt",icon:y("far fa-trash-can")},{label:()=>e(x,{to:"/login"},{default:()=>"Tizimdan chiqish"}),key:"reihufhjcnvxm",icon:y("fas fa-arrow-right-from-bracket")}],T=se(),Q=p([{key:"header",type:"render",render:()=>e("div",{class:"flex p-3 pb-0 ps-2 w-[215px]"},[e("div",{class:"flex items-center select-none"},[e("img",{round:!0,style:"margin-right: 8px;",src:`${z}/${m.value.profil_url}`,class:"w-[60px] rounded-md m-3",title:`${m.value.lastname} ${m.value.firstname}`}),e("div",[e("div",{class:"text-[13px] font-bold"},e("div",{innerHTML:`${m.value.lastname} ${m.value.firstname}`})),e("div",{class:"text-[13px] text-center"},e("div",{innerHTML:"Admin "}))])])])},{key:"header-divider",type:"divider"},{key:"Own_info",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-blue-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-blue-950"><i class="fas fa-user-check"></i></span>'},{class:""}),e("div",{class:"text-black ps-3"},{default:()=>"Shaxsiy ma'lumotlar"})]),props:{onClick:()=>{L.push("/editprofil")}}},{key:"update_photo",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-blue-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-blue-950"><i class="fas fa-camera-rotate"></i></span>'},{class:""}),e("div",{class:"text-black ps-3"},[e("label",{innerHTML:"Profil rasmini yangilash"},{class:"text-red-600 ps-3"})])]),props:{onClick:()=>{_.value=!0}}},{key:"sign_out",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-red-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-red-800"><i class="fas fa-arrow-right-from-bracket"></i></span>'},{class:""}),e("div",{class:"text-red-800 ps-3"},{default:()=>"Tizimdan chiqish"})]),props:{onClick:async()=>{try{const s=await fetch(`${z}admin/logout`,{method:"POST",credentials:"include"});s.ok?L.push("/login"):console.error("Logout failed:",await s.text())}catch(s){console.error("Logout failed:",s)}}}}]);function X(s){T.info(String(s))}let g=p(localStorage.collapsed=="true");return oe(g,(s,o)=>{s?localStorage.setItem("collapsed","true"):localStorage.setItem("collapsed","false")}),(s,o)=>{const S=h("n-button"),H=h("n-dropdown"),Y=h("n-menu"),Z=h("n-layout-sider"),ee=h("RouterView"),N=h("n-layout"),te=h("n-modal");return w(),k(ne,null,[l("div",_e,[l("div",ge,[c(n(x),{to:"/",class:"text-white"},{default:u(()=>[xe]),_:1}),l("div",ve,[c(he),c(H,{disabled:"",trigger:"hover",options:n(W),onSelect:G},{default:u(()=>[c(S,null,{default:u(()=>[l("img",{src:n(I)=="uz"?"/1670868198_grizly-club-p-flag-uzbekistana-png-9.png":"/EM7LidKw8aA.jpg",class:"w-[25px]",lt:""},null,8,be)]),_:1})]),_:1},8,["options"]),l("div",ye,[c(H,{trigger:"hover",options:Q.value,onSelect:X},{default:u(()=>[l("div",we,[l("img",{src:`${n(z)}/${n(m).profil_url}`,class:"w-[40px] h-[40px] rounded-[50%]",alt:""},null,8,ke),l("div",Se,[l("span",ze,V(n(m).lastname)+" "+V(n(m).firstname),1),$e])])]),_:1},8,["options"])])])]),c(N,{class:"h-full","has-sider":""},{default:u(()=>[c(Z,{bordered:"","collapse-mode":"width","collapsed-width":64,width:240,"show-trigger":"",inverted:n(E),collapsed:n(g),onCollapse:o[0]||(o[0]=j=>C(g)?g.value=!0:g=!0),onExpand:o[1]||(o[1]=j=>C(g)?g.value=!1:g=!1)},{default:u(()=>[c(Y,{class:"",inverted:n(E),"collapsed-width":64,"collapsed-icon-size":22,options:J},null,8,["inverted"])]),_:1},8,["inverted","collapsed"]),c(N,null,{default:u(()=>[l("div",Le,[c(ee)])]),_:1})]),_:1})]),c(te,{show:n(_),"onUpdate:show":o[2]||(o[2]=j=>C(_)?_.value=j:_=j),class:"custom-card",preset:"card",style:le(n(v)),title:" Profil rasmini o'zgartirish",bordered:!1,size:"huge",segmented:n(f)},{"header-extra":u(()=>[]),footer:u(()=>[B(" ### ")]),default:u(()=>[l("form",{onSubmit:re(q,["prevent"])},[l("label",Te,[n(i)?U("",!0):(w(),k("div",je,De))]),l("input",{type:"file",id:"picture",class:"hidden",accept:"image/*",onChange:M},null,32),d.value?(w(),k("img",{key:0,class:"w-[300px] h-[300px] block mx-auto rounded-[50%]",src:d.value,alt:""},null,8,Me)):U("",!0),l("div",Ie,[l("label",Re,[n(i)?(w(),k("div",Ce,Ve)):U("",!0)]),n(i)?(w(),k("button",Ae," Almashtirish ")):U("",!0)])],32)]),_:1},8,["show","style","segmented"])],64)}}};export{He as default};
