import{u as O,r as d,o as q,a as h,b as k,c as S,w as se,v as oe,d as s,e as c,f as u,g as n,F as B,h as z,D as le,i as ne,j as ie,k as E,n as re,R as v,t as V,l as G,m as D,p as ce,_ as de,q as e}from"./index-DnafoGEs.js";const ue="/assets/1--0rrEm_G.mp3";var i=[];for(var P=0;P<256;++P)i.push((P+256).toString(16).slice(1));function pe(t,a=0){return(i[t[a+0]]+i[t[a+1]]+i[t[a+2]]+i[t[a+3]]+"-"+i[t[a+4]]+i[t[a+5]]+"-"+i[t[a+6]]+i[t[a+7]]+"-"+i[t[a+8]]+i[t[a+9]]+"-"+i[t[a+10]]+i[t[a+11]]+i[t[a+12]]+i[t[a+13]]+i[t[a+14]]+i[t[a+15]]).toLowerCase()}var U,fe=new Uint8Array(16);function me(){if(!U&&(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!U))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(fe)}var he=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const K={randomUUID:he};function _e(t,a,x){if(K.randomUUID&&!a&&!t)return K.randomUUID();t=t||{};var p=t.random||(t.rng||me)();return p[6]=p[6]&15|64,p[8]=p[8]&63|128,pe(p)}const ge=s("source",{src:ue,type:"audio/mpeg"},null,-1),ve=[ge],xe=s("span",{class:"text-white material-symbols-outlined"}," notifications ",-1),be={__name:"ring",setup(t){let a=O();const x=d(null);d(0);let p=d(0),f=d([]),M=function(){a.push("/")},y=async function(){x.value&&x.value.addEventListener("play",()=>{console.log("Audio is playing")});const _=localStorage.token;let r=await fetch(`${z}notification/status`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":_}});r.status==200&&(r=await r.json(),r.length>0&&x.value.play(),f.value=[],r.forEach(b=>{p.value++,f.value.push({label:`${b.title} : ${new Date(b.start_time).toLocaleString()} ${new Date(b.end_time).toLocaleString()}`,key:`${_e()}`})})),r.status==401&&a.push("/login")};return q(async()=>{y()}),setInterval(()=>{y(),p.value=0},6e4),(_,r)=>{const b=h("n-badge"),I=h("n-dropdown");return k(),S(B,null,[se(s("audio",{ref_key:"audioElement",ref:x,controls:""},ve,512),[[oe,!1]]),s("div",null,[c(I,{trigger:"hover",options:n(f),onSelect:n(M)},{default:u(()=>[c(b,{class:"me-3",value:n(p),max:100},{default:u(()=>[xe]),_:1},8,["value"])]),_:1},8,["options","onSelect"])])],64)}}},ye={class:"bg-gray-200 overflow-hidden w-[100vw] h-[100vh]"},we={class:"w-full h-[50px] flex justify-between items-center bg-gray-900"},ke=s("span",{class:"me-5 flex justify-center w-[240px] block absolute text-white select-none text-[28px] flex items-center gap-1 top-[10px] left-[10px] font-semibold"},[s("img",{src:de,class:"w-[40px]",alt:""}),G(" "+V("Aileet"))],-1),Se={class:"flex gap-3 items-center"},$e=["src"],ze={class:"h-full w-[200px] cursor-pointer me-4"},Le={class:"h-full ps-3 flex items-center w-full border-s-[1px]"},Te=["src"],je={class:"flex flex-col"},De={class:"text-white font-bold ps-3"},Ue=s("span",{class:"text-white text-[12px] text-center"},"Admin",-1),Me={class:"p-3 pb-[100px]"},Ie={for:"picture"},Re={key:0,class:"w-[500px] cursor-pointer flex justify-center text-teal-500"},Ce=s("i",{class:"fas fa-cloud-arrow-up text-[40px] text-center"},null,-1),Ee=[Ce],Pe=["src"],Ve={class:"flex w-[600px] mx-auto mt-3 justify-around items-baseline"},Ae={for:"picture"},He={key:0,id:"bt",class:"rounded pe-3 ps-3 px-5 py-3 min-w-max overflow-hidden shadow relative bg-teal-500 text-white hover:bg-opacity-90"},Ne=s("i",{class:"fas fa-camera"},null,-1),Fe=[Ne],Ke={key:0,type:"submit",id:"bt",class:"rounded px-5 py-3 min-w-max overflow-hidden shadow block relative bg-teal-500 text-white hover:bg-opacity-90"},qe={__name:"dashtboard",setup(t){let a=le(),x={width:"600px"},p={content:"soft",footer:"soft"},f=d(!1),M=d(null),y;const _=d(null);let r=d(!1);const b=o=>{const l=o.target.files[0];if(M.value=o.target.files[0],l&&l.type.startsWith("image/")){y=new FormData,y.append("image",l),r.value=!0;const $=new FileReader;$.onload=()=>{_.value=$.result},$.readAsDataURL(l)}else T.error("Please select a valid image file."),o.target.value=""},I=async()=>{let o=localStorage.token;if(r.value){let l=await fetch(`${z}admin/changePhoto`,{method:"POST",headers:{"-x-token":o},body:y});if(l.status==200){r.value=!1,_.value=null,f.value=!1,A();return}if(l.status==401)return L.push("/login");if(l.status==400){l=await l.json(),T.error(l.error);return}_.value=null,l=await l.json(),r.value=!1}else T.error("No image selected.")};let m=d({profil_url:"",lastname:"",firstname:""});const L=O();async function A(){await a.getProfil()==401&&L.push("/login"),m.value=a.profile}q(async()=>{await A()});let R=d("uz"),W=[{label:"O'zb",key:"uz"},{label:"En",key:"en"}];function J(o){String(o)=="en"&&(localStorage.setItem("lang","en"),R.value="en"),String(o)=="uz"&&(localStorage.setItem("lang","uz"),R.value="uz")}function w(o){return()=>e("i",{class:o})}function C(o){return()=>e("span",{class:"material-symbols-outlined"},{default:()=>o})}let H=d(!0);const Q=[{label:"Murojaatlar",key:"pinball-1973",icon:C("group"),disabled:!1,children:[{label:()=>e(v,{to:"/allApeals"},{default:()=>"Murojaatlar"}),key:"addWorker",icon:C("group_add")},{label:()=>e(v,{to:"/Notification_apeal"},{default:()=>"Kutilyotgan murojaatlar"}),key:"Notification_apeal ",icon:w("fas fa-clock-rotate-left")},{label:()=>e(v,{to:"/Kalindar"},{default:()=>"Kalindar"}),key:"issues ",icon:w("fas fa-receipt")}]},{label:"Tizim",key:"Tizim",icon:C("engineering"),children:[{label:()=>e(v,{to:"/editprofil"},{default:()=>"Profilni tahrirlash"}),key:"Davomat",icon:w("fas fa-user-pen")},{label:()=>e(v,{to:"/changepassword"},{default:()=>"Parolni almashtirish"}),key:"changepassword",icon:w("fas fa-lock")}]},{label:()=>e(v,{to:"/korzinka"},{default:()=>"Korzinka"}),key:"kontrakt",icon:w("far fa-trash-can")},{label:()=>e(v,{to:"/login"},{default:()=>"Tizimdan chiqish"}),key:"reihufhjcnvxm",icon:w("fas fa-arrow-right-from-bracket")}],T=ne(),X=d([{key:"header",type:"render",render:()=>e("div",{class:"flex p-3 pb-0 ps-2 w-[215px]"},[e("div",{class:"flex items-center select-none"},[e("img",{round:!0,style:"margin-right: 8px;",src:`${z}/${m.value.profil_url}`,class:"w-[60px] rounded-md m-3",title:`${m.value.lastname} ${m.value.firstname}`}),e("div",[e("div",{class:"text-[13px] font-bold"},e("div",{innerHTML:`${m.value.lastname} ${m.value.firstname}`})),e("div",{class:"text-[13px] text-center"},e("div",{innerHTML:"Admin "}))])])])},{key:"header-divider",type:"divider"},{key:"Own_info",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-blue-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-blue-950"><i class="fas fa-user-check"></i></span>'},{class:""}),e("div",{class:"text-black ps-3"},{default:()=>"Shaxsiy ma'lumotlar"})]),props:{onClick:()=>{L.push("/editprofil")}}},{key:"update_photo",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-blue-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-blue-950"><i class="fas fa-camera-rotate"></i></span>'},{class:""}),e("div",{class:"text-black ps-3"},[e("label",{innerHTML:"Profil rasmini yangilash"},{class:"text-red-600 ps-3"})])]),props:{onClick:()=>{f.value=!0}}},{key:"sign_out",type:"render",label:"salom",render:()=>e("div",{class:"ps-4 duration-700 flex items-center hover:bg-red-200 cursor-pointer flex border-t-[1px] border-solid"},[e("span",{innerHTML:'<span class="text-[20px] text-red-800"><i class="fas fa-arrow-right-from-bracket"></i></span>'},{class:""}),e("div",{class:"text-red-800 ps-3"},{default:()=>"Tizimdan chiqish"})]),props:{onClick:async()=>{try{const o=await fetch(`${z}admin/logout`,{method:"POST",credentials:"include"});o.ok?L.push("/login"):console.error("Logout failed:",await o.text())}catch(o){console.error("Logout failed:",o)}}}}]);function Y(o){T.info(String(o))}let g=d(localStorage.collapsed=="true");return ie(g,(o,l)=>{o?localStorage.setItem("collapsed","true"):localStorage.setItem("collapsed","false")}),(o,l)=>{const $=h("n-button"),N=h("n-dropdown"),Z=h("n-menu"),ee=h("n-layout-sider"),te=h("RouterView"),F=h("n-layout"),ae=h("n-modal");return k(),S(B,null,[s("div",ye,[s("div",we,[c(n(v),{to:"/",class:"text-white"},{default:u(()=>[ke]),_:1}),s("div",Se,[c(be),c(N,{disabled:"",trigger:"hover",options:n(W),onSelect:J},{default:u(()=>[c($,null,{default:u(()=>[s("img",{src:n(R)=="uz"?"/1670868198_grizly-club-p-flag-uzbekistana-png-9.png":"/EM7LidKw8aA.jpg",class:"w-[25px]",lt:""},null,8,$e)]),_:1})]),_:1},8,["options"]),s("div",ze,[c(N,{trigger:"hover",options:X.value,onSelect:Y},{default:u(()=>[s("div",Le,[s("img",{src:`${n(z)}/${n(m).profil_url}`,class:"w-[40px] h-[40px] rounded-[50%]",alt:""},null,8,Te),s("div",je,[s("span",De,V(n(m).lastname)+" "+V(n(m).firstname),1),Ue])])]),_:1},8,["options"])])])]),c(F,{class:"h-full","has-sider":""},{default:u(()=>[c(ee,{bordered:"","collapse-mode":"width","collapsed-width":64,width:240,"show-trigger":"",inverted:n(H),collapsed:n(g),onCollapse:l[0]||(l[0]=j=>E(g)?g.value=!0:g=!0),onExpand:l[1]||(l[1]=j=>E(g)?g.value=!1:g=!1)},{default:u(()=>[c(Z,{class:"",inverted:n(H),"collapsed-width":64,"collapsed-icon-size":22,options:Q},null,8,["inverted"])]),_:1},8,["inverted","collapsed"]),c(F,null,{default:u(()=>[s("div",Me,[c(te)])]),_:1})]),_:1})]),c(ae,{show:n(f),"onUpdate:show":l[2]||(l[2]=j=>E(f)?f.value=j:f=j),class:"custom-card",preset:"card",style:re(n(x)),title:" Profil rasmini o'zgartirish",bordered:!1,size:"huge",segmented:n(p)},{"header-extra":u(()=>[]),footer:u(()=>[G(" ### ")]),default:u(()=>[s("form",{onSubmit:ce(I,["prevent"])},[s("label",Ie,[n(r)?D("",!0):(k(),S("div",Re,Ee))]),s("input",{type:"file",id:"picture",class:"hidden",accept:"image/*",onChange:b},null,32),_.value?(k(),S("img",{key:0,class:"w-[300px] h-[300px] block mx-auto rounded-[50%]",src:_.value,alt:""},null,8,Pe)):D("",!0),s("div",Ve,[s("label",Ae,[n(r)?(k(),S("div",He,Fe)):D("",!0)]),n(r)?(k(),S("button",Ke," Almashtirish ")):D("",!0)])],32)]),_:1},8,["show","style","segmented"])],64)}}};export{qe as default};
