import{D as P,r as d,h as R,u as I,i as D,o as O,a as g,b as l,c as m,f as t,e as s,q as u,w as v,l as h,d as x,j as k,k as G,t as c,F as A,g as M,s as V,v as Q}from"./index-BTxt8QXF.js";import{_ as J}from"./editapeals-jLKbMa-J.js";const K={class:"overflow-x-auto custom-scroll pb-[50px]"},W=t("p",{class:"text-lg"},[t("span",{class:"text-[20px] font-bold"}," Murojaatlar ")],-1),X={class:"mx-auto select-auto mt-5 w-full lg:w-[1200px] items-center gap-4 flex flex-col"},Y={class:"container overflow-x-clip"},Z=t("thead",null,[t("tr",null,[t("th",null,"№"),t("th",null,[t("div",{class:"text-center"}," F.I ")]),t("th",null,[t("div",{class:"text-center"},"Telefon raqami ")]),t("th",{class:"flex justify-center"},"Tasnifi"),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Holati")]),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Vaqti")]),t("th",{class:"text-center"},"Tahrirlash"),t("th",{class:"text-center"},"Qayta ko'rish"),t("th",{class:"text-center"},[t("div",{class:"text-red-600"},"O'chirish")])])],-1),tt={class:"text-justify ps-4 font-bold"},et={class:"text-center select-text"},st={class:"text-center"},at={class:"text-center"},lt={class:"text-center"},nt={class:"flex justify-center"},ot=t("i",{class:"fas fa-pen"},null,-1),it={key:0},ct={key:1},rt={class:"flex justify-center"},dt=t("i",{class:"far fa-trash-can"},null,-1),ut=t("thead",null,[t("tr",null,[t("th",null,"№"),t("th",null,[t("div",{class:"text-center"}," F.I ")]),t("th",null,[t("div",{class:"text-center"},"Telefon raqami ")]),t("th",{class:"flex justify-center"},"Tasnifi"),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Holati")]),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Vaqti")]),t("th",null,"####")])],-1),ht={class:"text-center font-bold"},_t={class:"text-center"},pt={class:"text-center"},ft={class:"text-center"},mt={class:"text-center"},xt={class:"text-center"},gt={class:"font-bold"},vt=t("span",{class:"text-green-600"},"Barcha ma'lumotlar soni ",-1),kt=["title"],Ct={__name:"Apeal",setup(yt){let _=P();function E(i){_.modals.editApeal.show=!0,_.modals.editApeal.data=i}let y=d(""),p=d(!1),w=d(null),F=async function(){let i=localStorage.token;try{let a=await fetch(`${M}apeal/edit/byid/${w.value}`,{method:"DELETE",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":i}});if(a.status==200){j.success("Ma'lumot o'chirilid"),b(r.value);return}if(a.status==401)return S.push("/login");a.status==400&&(a=await a.json(),j.error(a.error))}catch{}},L=function(){},r=d(1),j=R(),$=d(10),T=d([]),N=d(1),o=d(!1),z=d(0),S=I();D(r,(i,a)=>{b(i)});let b=async i=>{T.value=[],o.value=!0;let a=localStorage.token;try{let n=await fetch(`${M}apeal/getapeal/all?${new URLSearchParams({page:i,size:$.value}).toString()}`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":a}});if(n.status==200){n=await n.json(),N.value=Math.ceil(new Number(n[0].total)/10),T.value=[...n],o.value=!1,z.value=n[0].total;return}if(n.status==401)return S.push("/login")}catch(n){if(n.message=="Failed to fetch")return j.error("Server bilan aloqa uzildi")}};return O(async()=>{b(1)}),D(()=>_.modals.editApeal.loading,(i,a)=>{i&&b(r.value)},{deep:!0}),(i,a)=>{const n=g("n-button"),q=g("n-table"),f=g("n-skeleton"),U=g("n-pagination"),B=g("n-modal");return l(),m(A,null,[t("div",null,[t("div",K,[W,t("div",X,[t("div",Y,[s(o)?h("",!0):(l(),u(q,{key:0,bordered:!1,"single-line":!1},{default:v(()=>[Z,t("tbody",null,[(l(!0),m(A,null,V(s(T),(e,C)=>(l(),m("tr",{class:"bg-red-600",key:new Number(e.id)},[t("td",null,c(C+1+(s(r)-1)*s($)),1),t("td",tt,[t("span",{class:Q(e.status==4?"line-through text-red-700":"")},c(e.lastname)+" "+c(e.firstname),3)]),t("td",et,c(e.phone),1),t("td",st,c(e.description),1),t("td",at,c(e.statusname),1),t("td",lt,c(new Date(e.created_at).toLocaleString()),1),t("td",null,[t("div",nt,[x(n,{type:"tertiary",onClick:H=>E(e)},{default:v(()=>[ot]),_:2},1032,["onClick"])])]),e.reseen?(l(),m("td",it,c(new Date(e.reseen).toLocaleString()),1)):(l(),m("td",ct,"Mavjud emas")),t("td",null,[t("div",rt,[x(n,{type:"error",onClick:H=>{k(p)?p.value=!0:p=!0,k(w)?w.value=e.id:w=e.id,k(y)?y.value=`${e.lastname} ${e.firstname}dan kelgan taklifni o'chirasizmi ?`:y=`${e.lastname} ${e.firstname}dan kelgan taklifni o'chirasizmi ?`}},{default:v(()=>[dt]),_:2},1032,["onClick"])])])]))),128))])]),_:1})),s(o)?(l(),u(q,{key:1,bordered:!1,"single-line":!1},{default:v(()=>[ut,t("tbody",null,[(l(),m(A,null,V(5,(e,C)=>t("tr",{key:C},[t("td",null,c(+ +C+(s(r)-1)*s($)),1),t("td",ht,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)]),t("td",_t,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)]),t("td",pt,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)]),t("td",ft,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)]),t("td",mt,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)]),t("td",xt,[s(o)?(l(),u(f,{key:0,height:"40px",width:"100%"})):h("",!0)])])),64))])]),_:1})):h("",!0)]),x(U,{page:s(r),"onUpdate:page":a[0]||(a[0]=e=>k(r)?r.value=e:r=e),"page-count":s(N)},null,8,["page","page-count"]),t("div",gt,[vt,G(": "),t("span",{title:s(z)},c(s(z)),9,kt)])])])]),x(B,{show:s(_).modals.editApeal.show,"onUpdate:show":a[1]||(a[1]=e=>s(_).modals.editApeal.show=e),class:"custom-card",preset:"card",style:{width:"600px"},title:`${s(_).modals.editApeal.data.lastname} ${s(_).modals.editApeal.data.firstname}`,bordered:!0,size:"huge",segmented:{content:"soft",footer:"soft"}},{default:v(()=>[x(J)]),_:1},8,["show","title"]),x(B,{show:s(p),"onUpdate:show":a[2]||(a[2]=e=>k(p)?p.value=e:p=e),preset:"dialog",title:"O'chirish",content:s(y),"positive-text":"Ha","negative-text":"Bekor qilindi",onPositiveClick:s(F),onNegativeClick:s(L)},null,8,["show","content","onPositiveClick","onNegativeClick"])],64)}}};export{Ct as default};
