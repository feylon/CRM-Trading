import{D as R,r as n,i as K,a5 as G,u as I,j as D,o as Q,a as f,b as p,c as k,d as t,e as c,f as h,g as s,s as J,k as d,m as W,l as E,t as o,F as M,h as T,x as X,y as Y}from"./index-DnafoGEs.js";import{_ as Z}from"./editapeals-DBfDkw69.js";const tt={class:"overflow-x-auto custom-scroll pb-[50px]"},et=t("p",{class:"text-lg"},[t("span",{class:"text-[20px] font-bold"}," Korzinka ")],-1),at={class:"mx-auto select-auto mt-5 w-full lg:w-[1200px] items-center gap-4 flex flex-col"},st={class:"container overflow-x-clip"},lt=t("thead",null,[t("tr",null,[t("th",null,"â„–"),t("th",null,[t("div",{class:"text-center"}," F.I ")]),t("th",null,[t("div",{class:"text-center"},"Telefon raqami ")]),t("th",{class:"flex justify-center"},"Tasnifi"),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Holati")]),t("th",{class:"text-center"},[t("div",{class:"text-center"},"Vaqti")]),t("th",{class:"text-center"},[t("div",{class:"text-red-600"},"O'chirish")]),t("th",{class:"text-center"},"Qayta ko'rish"),t("th",{class:"text-center"},[t("div",{class:"text-green-600"},"Tiklash")])])],-1),nt={class:"text-justify ps-4 font-bold"},ot={class:"text-center select-text"},it={class:"text-center"},rt={class:"text-center"},ct={class:"text-center"},dt={class:"flex justify-center"},ut=t("i",{class:"far fa-trash-can"},null,-1),ht={key:0},ft={key:1},pt={class:"flex justify-center"},mt=t("i",{class:"fas fa-arrow-rotate-left"},null,-1),_t={class:"font-bold"},vt=t("tr",null,[t("td",{colspan:"9"},[t("div",{class:"w-full flex justify-center"},[t("i",null,"Ma'lumot mavjud emas")])])],-1),gt={class:"font-bold"},kt=t("span",{class:"text-red-600"},"Barcha o'chirilgan ma'lumotlar soni ",-1),xt=["title"],Ct={__name:"Corzina",setup(wt){let m=R(),x=n(""),u=n(!1),w=n(null),_=n(""),y=n(!1),b=n(null),L=async function(){let i=localStorage.token;try{let a=await fetch(`${T}apeal/edit/recover/${w.value}`,{method:"DELETE",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":i}});if(a.status==200){v.success("Ma'lumot tiklandi"),g(r.value);return}if(a.status==401)return $.push("/login");a.status==400&&(a=await a.json(),v.error(a.error))}catch{}},N=function(){},r=n(1),v=K();const P=G();let S=n(10),C=n([]),q=n(1),j=n(0),$=I();D(r,(i,a)=>{g(i)});let g=async i=>{C.value=[];let a=localStorage.token;try{let l=await fetch(`${T}apeal/getapeal/corzinca?${new URLSearchParams({page:i,size:S.value}).toString()}`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":a}});if(l.status==200){l=await l.json(),q.value=Math.ceil(new Number(l[0].total)/10),C.value=[...l],j.value=l[0].total;return}if(l.status==401)return $.push("/login")}catch(l){if(l.message=="Failed to fetch")return v.error("Server bilan aloqa uzildi")}};Q(async()=>{g(1)}),D(()=>m.modals.editApeal.loading,(i,a)=>{i&&g(r.value)},{deep:!0});let B=function(){P.error({title:"Buni tiklashni imkoni yo'q!!!",content:_.value,positiveText:"O'chirilsin",onPositiveClick:async()=>{let i=localStorage.token;try{let a=await fetch(`${T}apeal/edit/alldelete/${b.value}`,{method:"DELETE",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":i}});if(a.status==200){v.success("Ma'lumot o'chirildi"),g(r.value),$.go(0);return}if(a.status==401)return $.push("/login");a.status==400&&(a=await a.json(),v.error(a.error))}catch{}}})};return(i,a)=>{const l=f("n-button"),A=f("n-popover"),U=f("n-table"),V=f("n-watermark"),F=f("n-pagination"),z=f("n-modal");return p(),k(M,null,[t("div",null,[t("div",tt,[et,t("div",at,[t("div",st,[c(V,{content:"Korzinka",cross:"",selectable:"","font-size":20,"line-height":16,width:192,height:128,"x-offset":12,"y-offset":28,rotate:-15},{default:h(()=>[c(U,{bordered:!1,"single-line":!1},{default:h(()=>[lt,t("tbody",null,[(p(!0),k(M,null,X(s(C),(e,O)=>(p(),k("tr",{class:"bg-red-600",key:new Number(e.id)},[t("td",null,o(O+1+(s(r)-1)*s(S)),1),t("td",nt,[t("span",{class:Y(e.status==4?"line-through text-red-700":"")},o(e.lastname)+" "+o(e.firstname),3)]),t("td",ot,o(e.phone),1),t("td",it,o(e.description),1),t("td",rt,o(e.statusname),1),t("td",ct,o(new Date(e.created_at).toLocaleString()),1),t("td",null,[t("div",dt,[c(l,{type:"error",onClick:H=>{d(b)?b.value=e.id:b=e.id,d(_)?_.value=`${e.lastname} ${e.firstname} to'liq o'chirilsinmi?`:_=`${e.lastname} ${e.firstname} to'liq o'chirilsinmi?`,s(B)()}},{default:h(()=>[ut]),_:2},1032,["onClick"])])]),e.reseen?(p(),k("td",ht,o(new Date(e.reseen).toLocaleString()),1)):(p(),k("td",ft,"Mavjud emas")),t("td",null,[t("div",pt,[c(A,{trigger:"hover"},{trigger:h(()=>[c(l,{type:"success",onClick:H=>{d(u)?u.value=!0:u=!0,d(w)?w.value=e.id:w=e.id,d(x)?x.value=`${e.lastname} ${e.firstname} tiklansinmi ?`:x=`${e.lastname} ${e.firstname} tiklansinmi ?`}},{default:h(()=>[mt]),_:2},1032,["onClick"])]),default:h(()=>[t("span",null,[t("span",_t,o(e.lastname)+" "+o(e.firstname),1),E("ni tiklash")])]),_:2},1024)])])]))),128)),vt])]),_:1})]),_:1})]),s(C).length?(p(),J(F,{key:0,page:s(r),"onUpdate:page":a[0]||(a[0]=e=>d(r)?r.value=e:r=e),"page-count":s(q)},null,8,["page","page-count"])):W("",!0),t("div",gt,[kt,E(": "),t("span",{title:s(j)},o(s(j)),9,xt)])])])]),c(z,{show:s(m).modals.editApeal.show,"onUpdate:show":a[1]||(a[1]=e=>s(m).modals.editApeal.show=e),class:"custom-card",preset:"card",style:{width:"600px"},title:`${s(m).modals.editApeal.data.lastname} ${s(m).modals.editApeal.data.firstname}`,bordered:!0,size:"huge",segmented:{content:"soft",footer:"soft"}},{default:h(()=>[c(Z)]),_:1},8,["show","title"]),c(z,{show:s(u),"onUpdate:show":a[2]||(a[2]=e=>d(u)?u.value=e:u=e),preset:"dialog",title:"O'chirish",content:s(x),"positive-text":"Ha","negative-text":"Bekor qilindi",onPositiveClick:s(L),onNegativeClick:s(N)},null,8,["show","content","onPositiveClick","onNegativeClick"]),c(z,{show:s(y),"onUpdate:show":a[3]||(a[3]=e=>d(y)?y.value=e:y=e),preset:"dialog",title:"O'chirish",content:s(_),"positive-text":"Ha","negative-text":"Bekor qilindi",onPositiveClick:s(B),onNegativeClick:s(N)},null,8,["show","content","onPositiveClick","onNegativeClick"])],64)}}};export{Ct as default};
