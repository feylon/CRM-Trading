import{i as D,u as q,D as N,r as _,j as U,o as V,h as f,a as m,b as S,c as j,d as a,e as d,g as c,m as $,s as B,k as M,f as E,l as O}from"./index-DnafoGEs.js";const F={class:"container"},G={class:"flex justify-around"},J={class:"flex gap-3 items-center"},P=a("div",{class:"font-bold"},"Familiyasi",-1),R={class:"w-[150px]"},H={class:"flex gap-3 items-center"},I=a("div",{class:"font-bold"},"Ismi",-1),L={class:"w-[150px]"},Y={class:"flex mt-4 justify-around"},z={class:"flex gap-3 items-center"},K=a("div",{class:"font-bold"},"Telefon",-1),Q={class:"w-[150px]"},W={class:"flex gap-3 items-center"},X=a("div",{class:"font-bold"},"Vaqti",-1),Z={class:"w-[150px]"},ee={class:"mt-4"},te=a("div",{class:"font-bold"}," Description ",-1),ae={class:"flex justify-around"},se={class:"mt-4"},oe=a("div",{class:"font-bold"}," Holati ",-1),ne={class:"mt-4"},le={key:0,class:"font-bold"},ie={class:"flex justify-end mt-5"},ce={__name:"editapeals",setup(de){let h=D();const v=q(),l=N();let T=new Date().getTime();const o=_({firstname:"",lastname:"",phone:"",created_at:"",description:"",status_id:0,reseen:T});U(()=>o,(n,e)=>{n._value.status_id==3?r.value=!0:r.value=!1},{deep:!0});const y=_([]);let u=_(T),r=_(!1),A=async function(){l.modals.editApeal.data.id;let n=localStorage.token,e=await fetch(`${f}apeal/getapeal/apealstatus`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":n}});if(e.status==401)return v.push("/login");e.status==200&&(e=await e.json(),y.value=[],e.forEach(t=>{y.value.push({value:t.id,label:t.name})}))};V(async()=>{{let{id:n}=l.modals.editApeal.data,e=localStorage.token;n=new Number(n);let t=await fetch(`${f}apeal/getapeal/byid?id=${n}`,{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":e}});if(t.status==401)return v.push("/login");t.status==200&&(t=await t.json(),t=t[0],t.created_at=new Date(t.created_at).toLocaleString(),t.reseen&&(r.value=!0,u.value=new Date(t.reseen).getTime()),o.value=t)}await A()});async function C(n){const e=n.reseen,t=new Date(e),g=t.getFullYear(),k=String(t.getMonth()+1).padStart(2,"0"),x=String(t.getDate()).padStart(2,"0");n.reseen=`${g}-${k}-${x}`;let s=localStorage.token;if(n.panding){const{status:b,id:w,reseen:p}=n;try{let i=await fetch(`${f}apeal/edit/byid/${w}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":s},body:JSON.stringify({status:b,reseen:p})});if(i.status==200){h.success("Ma'lumotlar muvaqiyatli saqlandi"),l.modals.editApeal.show=!1,l.modals.editApeal.data={},l.modals.editApeal.loading=!0;return}if(i.status==401)return v.push("/login");i.status==400&&(i=await i.json(),h.error(i.error))}catch{}}else{const{status:b,id:w}=n;try{let p=await fetch(`${f}apeal/edit/byid/${w}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","-x-token":s},body:JSON.stringify({status:b})});if(p.status==200){h.success("Ma'lumotlar muvaqiyatli saqlandi"),l.modals.editApeal.show=!1,l.modals.editApeal.data={},l.modals.editApeal.loading=!0;return}if(p.status==401)return v.push("/login")}catch{}}}return(n,e)=>{const t=m("n-input"),g=m("n-select"),k=m("n-date-picker"),x=m("n-button");return S(),j("div",F,[a("div",G,[a("div",J,[P,a("div",R,[d(t,{readonly:"",value:o.value.lastname,"onUpdate:value":e[0]||(e[0]=s=>o.value.lastname=s)},null,8,["value"])])]),a("div",H,[I,a("div",L,[d(t,{readonly:"",value:o.value.firstname,"onUpdate:value":e[1]||(e[1]=s=>o.value.firstname=s)},null,8,["value"])])])]),a("div",Y,[a("div",z,[K,a("div",Q,[d(t,{readonly:"",value:o.value.phone,"onUpdate:value":e[2]||(e[2]=s=>o.value.phone=s)},null,8,["value"])])]),a("div",W,[X,a("div",Z,[d(t,{readonly:"",value:o.value.created_at,"onUpdate:value":e[3]||(e[3]=s=>o.value.created_at=s)},null,8,["value"])])])]),a("div",ee,[te,d(t,{readonly:"",value:o.value.description,"onUpdate:value":e[4]||(e[4]=s=>o.value.description=s),type:"textarea",placeholder:"Basic Textarea"},null,8,["value"])]),a("div",ae,[a("div",se,[oe,d(g,{value:o.value.status_id,"onUpdate:value":e[5]||(e[5]=s=>o.value.status_id=s),options:y.value},null,8,["value","options"])]),a("div",ne,[c(r)||o.value.status_id.id==3?(S(),j("div",le," Vaqti ")):$("",!0),c(r)||o.value.status_id.id==3?(S(),B(k,{key:1,value:c(u),"onUpdate:value":e[6]||(e[6]=s=>M(u)?u.value=s:u=s),type:"date"},null,8,["value"])):$("",!0)])]),a("div",ie,[d(x,{onClick:e[7]||(e[7]=s=>C({status:o.value.status_id,id:c(l).modals.editApeal.data.id,panding:c(r),reseen:c(u)}))},{default:E(()=>[O("Saqlash")]),_:1})])])}}};export{ce as _};
